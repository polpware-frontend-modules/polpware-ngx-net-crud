!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common/http"),require("rxjs"),require("@polpware/fe-utilities"),require("@polpware/ngx-rxjs"),require("@polpware/ngx-events"),require("@polpware/ngx-spinner")):"function"==typeof define&&define.amd?define("@polpware/ngx-net-crud",["exports","@angular/common/http","rxjs","@polpware/fe-utilities","@polpware/ngx-rxjs","@polpware/ngx-events","@polpware/ngx-spinner"],e):e((t.polpware=t.polpware||{},t.polpware["ngx-net-crud"]={}),t.ng.common.http,t.rxjs,t.feUtilities,t.ngxRxjs,t.ngxEvents,t.ngxSpinner)}(this,function(t,n,e,i,o,r,s){"use strict";var p=function(){function t(t){this.withCredentialOnRequest=!0,this.subject=new e.BehaviorSubject([]),this.http=t.get(n.HttpClient),this.eventsService=t.get(r.GlobalEventsService),this.spinner=new s.NullSpinner}return t.prototype.handleError=function(t){this.eventsService.broadcast("http-error",[t])},t.prototype.onDataChange=function(){return this.subject.asObservable()},t.prototype.parseCreateResponse=function(t,e){var r=e;return t.id=r,t},t.prototype.parseUpdateResponse=function(t,e){return t},t.prototype.parseListResponse=function(t){return t},t.prototype.listRequest=function(t){var e=new n.HttpParams;for(var r in t)t.hasOwnProperty(r)&&(e=e.set(r,t[r]));return this.http.get(this.listUrl(),{withCredentials:this.withCredentialOnRequest,params:e})},t.prototype.getListAsync=function(t,e){var r=this;if(void 0===e&&(e=null),this.getListGuard())return i.liftIntoReject("not allowed");var n=e||this.spinner;return n.show(),o.toPromise(this.listRequest(t)).then(function(t){n.hide();var e=r.parseListResponse(t);return r.notifyList(e),e},function(t){return n.hide(),r.handleError(t),t})},t.prototype.deleteByIdRequest=function(t){return this.http["delete"](this.deleteUrl(t),{withCredentials:this.withCredentialOnRequest})},t.prototype.deleteByIdAsync=function(e,t){var r=this;if(void 0===t&&(t=null),this.deleteByIdGuard(e))return i.liftIntoReject("not allowed");var n=t||this.spinner;return n.show(),o.toPromise(this.deleteByIdRequest(e)).then(function(t){return n.hide(),r.notifyDelete(e),e},function(t){return n.hide(),r.handleError(t),t})},t.prototype.adaptorCreateInput=function(t){return t},t.prototype.createRequest=function(t){var e={},r=this.adaptorCreateInput(t);for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n]);return this.http.post(this.createUrl(),e,{withCredentials:this.withCredentialOnRequest})},t.prototype.createAsync=function(e,t){var r=this;void 0===t&&(t=null);var n=t||this.spinner;return n.show(),o.toPromise(this.createRequest(e)).then(function(t){return n.hide(),e=r.parseCreateResponse(e,t),r.notifyCreate(e),e},function(t){return n.hide(),r.handleError(t),t})},t.prototype.adaptorUpdateInput=function(t){return t},t.prototype.updateRequest=function(t){var e={},r=this.adaptorUpdateInput(t);for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n]);return this.http.put(this.updateUrl(t.id),e,{withCredentials:this.withCredentialOnRequest})},t.prototype.updateAsync=function(e,t){var r=this;void 0===t&&(t=null);var n=t||this.spinner;return n.show(),o.toPromise(this.updateRequest(e)).then(function(t){return n.hide(),e=r.parseUpdateResponse(e,t),r.notifyUpdate(e),e},function(t){return n.hide(),r.handleError(t),t})},t}(),a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var u=function(e){function t(t){return e.call(this,t)||this}return function n(t,e){function r(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(t,e),t.prototype.buildPublishData=function(){return this.primaryTable.dataProvider().models.map(function(t){return t.attributes})},t.prototype.listenToPrimaryTable=function(){var e=this;this.primaryTable.dataProvider().on("update",function(){console.log("Received pimary table updates");var t=e.buildPublishData();e.subject.next(t)})},t.prototype.publishInitData=function(){var t=this.buildPublishData();this.subject.next(t)},t.prototype.getListGuard=function(){return!1},t.prototype.getById=function(t){var e=this.primaryTable.get(t);return e?e.attributes:null},t.prototype.getByIdAsync=function(t,e){throw void 0===e&&(e=null),new Error("Not implemented")},t.prototype.deleteByIdGuard=function(t){return!1},t.prototype.notifyDelete=function(t){var e=this.primaryTable.get(t);e&&e.destroyFromTable()},t.prototype.notifyCreate=function(t){this.primaryTable.add(t)},t.prototype.notifyUpdate=function(t){this.primaryTable.add(t)},t}(p);t.ObservableCurdService=p,t.ObservableDuetTableService=u,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=polpware-ngx-net-crud.umd.min.js.map